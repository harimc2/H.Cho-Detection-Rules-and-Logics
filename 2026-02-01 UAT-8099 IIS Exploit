<IIS webshell used to execute reconnaissance commands>
action='createprocess' AND filename.dst IN ('cmd.exe','powershell.exe') 
  AND parent.filename.src='w3wp.exe' 
  AND param.dst contains 'whoami' OR param.dst contains 'tasklist'
\\Webshells under IIS commonly execute basic host reconnaissance commands immediately after compromise.
\\MITRE: T1505.003, T1082

<Hidden local user account with dollar-sign suffix created>
action='createprocess' AND filename.dst IN ('net.exe','net1.exe') 
  AND param.dst contains 'user' AND param.dst contains '/add' 
  AND param.dst matches '.*\\$'
\\UAT-8099 creates hidden persistence accounts using names ending with '$' (admin$, mysql$, admin1$).
\\MITRE: T1136.001, T1078

<Hidden account added to local Administrators group>
action='createprocess' AND filename.dst IN ('net.exe','net1.exe') 
  AND param.dst contains 'localgroup administrators' 
  AND param.dst matches '.*\\$'
\\Adding dollar-suffixed users to Administrators enables stealthy long-term privileged access.
\\MITRE: T1098, T1078

<PowerShell executed from IIS context to deploy VBScript>
action='createprocess' AND filename.dst='powershell.exe' 
  AND parent.filename.src='w3wp.exe' 
  AND param.dst contains '.vbs'
\\IIS webshell spawns PowerShell to write or execute VBScript loaders for GotoHTTP deployment.
\\MITRE: T1059.001, T1505.003

<VBScript downloads executable to Public folder>
action='createfile' AND filepath contains '\\Users\\Public\\' AND filepath endswith '.exe'
  AND parent.filename.src IN ('wscript.exe','cscript.exe')
\\Malicious VBScript downloads GotoHTTP tool to Public directory for execution.
\\MITRE: T1105

<GotoHTTP binary executed with hidden window>
action='createprocess' AND filename.dst endswith '.exe' 
  AND parent.filename.src IN ('wscript.exe','cscript.exe') 
  AND param.dst contains '0' OR param.dst contains 'hide'
\\GotoHTTP is executed silently to establish remote control without user interaction.
\\MITRE: T1218, T1059.005

<GotoHTTP configuration file exfiltration>
action='network_connect' AND direction='outbound' 
  AND later action='openfile' AND filepath endswith 'gotohttp.ini' within 60s
\\The attacker uploads gotohttp.ini to retrieve connection ID and password for remote control.
\\MITRE: T1041

<Archive deployment from region-tagged ZIP files>
action='createfile' AND filepath contains '\\Desktop\\' AND filepath endswith '.zip'
  AND (filepath contains 'VN' OR filepath contains 'TH')
\\BadIIS payloads are delivered in region-specific archives (VN.zip / TH.zip).
\\MITRE: T1105

<BadIIS DLLs written to user Desktop region folders>
action='createfile' AND filepath contains '\\Desktop\\' 
  AND (filepath endswith '.dll' AND (filepath contains '\\VN\\' OR filepath contains '\\newth\\'))
\\BadIIS variants are unpacked into region-named directories to support targeted SEO fraud.
\\MITRE: T1505.003

<Batch scripts used to install or uninstall IIS backdoor>
action='createprocess' AND filename.dst='cmd.exe' 
  AND param.dst endswith 'install.bat' OR param.dst endswith 'uninstall.bat'
\\BadIIS uses install/uninstall batch scripts to modify IIS configuration and persist.
\\MITRE: T1547.001

<IIS HTTP module hijacking using custom DLL>
action='loadmodule' AND process.filename.src='w3wp.exe' 
  AND module.filepath contains '\\Desktop\\' 
  AND module.filepath endswith '.dll'
\\BadIIS hijacks IIS request handling by loading attacker DLLs into w3wp.exe.
\\MITRE: T1505.003, T1055

<Accept-Language based traffic manipulation for SEO fraud>
action='http_request' AND request.headers contains 'Accept-Language' 
  AND request.headers contains 'th' 
  AND response.body contains '<script'
\\BadIIS inspects Accept-Language headers (Thai/Vietnamese) to selectively inject malicious JavaScript.
\\MITRE: T1565.002, T1071.001

<Accept-Language based traffic manipulation for SEO fraud>
action='http_request' AND request.headers contains 'Accept-Language' 
  AND request.headers contains 'th' 
  AND response.body contains '<script'
\\BadIIS inspects Accept-Language headers (Thai/Vietnamese) to selectively inject malicious JavaScript.
\\MITRE: T1565.002, T1071.001

<Dynamic HTML injection with SEO keyword placeholders>
action='http_response' AND response.body contains '{biaoti}' OR response.body contains '{guanjianci}'
\\Injected HTML templates using Chinese Pinyin placeholders indicate BadIIS dynamic SEO fraud content generation.
\\MITRE: T1565.002

<XOR-obfuscated content decoded in IIS process>
process.filename.src='w3wp.exe' AND process.api_call contains 'xor' 
  AND later response.body contains '<script'
\\BadIIS variants XOR-decode malicious HTML/JS payloads before injecting into responses.
\\MITRE: T1027, T1565.002

<Linux IIS-like SEO backdoor (ELF BadIIS) serving gambling redirects>
action='network_listen' AND process.filetype='ELF' 
  AND response.body contains 'bet' OR response.body contains 'casino'
\\ELF BadIIS variant mirrors Windows behavior, providing SEO fraud and redirect services on Linux hosts.
\\MITRE: T1505.003

<High-confidence chain: IIS webshell → hidden admin account → GotoHTTP deploy → BadIIS DLL load>
action='createprocess' AND parent.filename.src='w3wp.exe' AND filename.dst IN ('cmd.exe','powershell.exe')
  AND later action='createprocess' AND param.dst matches '.*\\$' 
  AND later action='createfile' AND filepath endswith 'gotohttp.exe' 
  AND later action='loadmodule' AND module.filepath endswith '.dll'
\\Full UAT-8099 lifecycle: IIS webshell access, stealth admin persistence, remote control via GotoHTTP, and BadIIS SEO backdoor deployment.
\\MITRE: T1505.003, T1136.001, T1105, T1565.002

