<PeckBirdy initial script download via LOLBins (HTA/WScript/MSHTA)>
action='createprocess' AND filename.dst IN ('mshta.exe','wscript.exe','cscript.exe') 
  AND param.dst contains 'http' AND param.dst contains '/hta' OR param.dst contains '/wscript' 
  AND user.all NOT IN ('NT AUTHORITY\\SYSTEM')
\\PeckBirdy delivers its landing scripts through LOLBins like MSHTA/WScript to maximize compatibility and evade controls.
\\MITRE: T1218, T1059.007

<Browser-based PeckBirdy execution writing unique victim ID to Temp>
action='createfile' AND filepath contains '\\AppData\\Local\\Temp\\___unique_id___' 
  AND parent.filename.src IN ('mshta.exe','wscript.exe','browser.exe','iexplore.exe')
\\PeckBirdy persists a victim identifier by writing a file named ___unique_id___ into Temp for reuse across executions.
\\MITRE: T1070.004, T1036

<Abnormal cookie creation with Hm_lvt_ prefix from injected website>
action='http_response' AND response.headers.set_cookie contains 'Hm_lvt_' 
  AND source.process IN ('browser.exe','iexplore.exe','chrome.exe','msedge.exe')
\\PeckBirdy mimics legitimate analytics cookies (Hm_lvt_) to store victim IDs inside browsers after script injection.
\\MITRE: T1555, T1056

<WebSocket or Comet-style C2 from script host>
action='network_connect' AND protocol IN ('WebSocket','HTTP','HTTPS') 
  AND process.filename.src IN ('mshta.exe','wscript.exe','cscript.exe','node.exe') 
  AND count(network_connect) >= 5 within 1800s by process.pid
\\PeckBirdy prefers WebSocket C2 but falls back to HTTP-based Comet/LocalComet methods for compatibility.
\\MITRE: T1071.001

<Script detects execution environment using window/process/response objects>
action='createprocess' AND filename.dst IN ('mshta.exe','wscript.exe','node.exe') 
  AND param.dst contains 'typeof window' OR param.dst contains 'typeof process' OR param.dst contains 'typeof response'
\\PeckBirdy performs runtime environment detection (browser, HTA, ASP, NodeJS) to adapt behavior dynamically.
\\MITRE: T1059, T1027

<PeckBirdy AES/Base64 encrypted traffic following init request>
action='network_connect' AND direction='outbound' 
  AND request.body matches '[A-Za-z0-9+/]{200,}={0,2}' 
  AND earlier request.body contains '"action":"init"' within 300s
\\After init, PeckBirdy encrypts communications with AES and Base64 using ATTACK_ID-derived keys.
\\MITRE: T1027, T1071.001

<HOLODONUT loader initial connection sending string#{string} handshake>
action='network_connect' AND direction='outbound' 
  AND request.body matches '^[^#]{3,}#[^#]{3,}$' 
  AND process.filename.src NOT IN ('browser.exe')
\\HOLODONUT downloader (NEXLOAD) uses a distinctive initial handshake format: {string}#{string}.
\\MITRE: T1071, T1105

<HOLODONUT in-memory .NET execution via EnumWindows callback>
action='process_memory_alloc' AND process.api_call contains 'EnumWindows' 
  AND later process.api_call contains 'VirtualAlloc' OR process.api_call contains 'CreateThread'
\\HOLODONUT executes decrypted .NET payloads in memory using EnumWindows callbacks and Donut-style loaders.
\\MITRE: T1055, T1620

<HOLODONUT defense evasion: AMSI and ETW patching>
process.filename.src NOT IN ('powershell.exe') 
  AND (process.api_call contains 'AmsiScanBuffer' OR process.api_call contains 'EtwEventWrite') 
  AND process_modify contains 'patch'
\\HOLODONUT disables AMSI and ETW telemetry to evade in-memory detection during execution.
\\MITRE: T1562.001, T1562.006

<MKDOOR fake Microsoft support/activation URL pattern>
action='network_connect' AND direction='outbound' 
  AND request.uri contains '/en-us/' 
  AND request.uri contains 'howtotell' OR request.uri contains 'activate-windows'
\\MKDOOR disguises C2 paths as Microsoft support or Windows activation URLs to blend with legitimate traffic.
\\MITRE: T1071.001, T1036

<MKDOOR opens local HTTP listener on high port>
action='network_listen' AND process.filename.src NOT IN ('iisexpress.exe','httpd.exe') 
  AND dest.port > 40000
\\MKDOOR opens a local high-numbered port HTTP server to signal infection status to watering-hole scripts.
\\MITRE: T1071, T1090

<Reverse shell via script-based TCP socket>
action='network_connect' AND protocol='TCP' 
  AND process.filename.src IN ('mshta.exe','wscript.exe','node.exe') 
  AND dest.port NOT IN (80,443)
\\PeckBirdy supports reverse shells implemented directly in script via raw TCP sockets.
\\MITRE: T1059, T1071

<High-confidence PeckBirdy chain: injected script → LOLBin exec → victim ID write → encrypted C2>
action='createprocess' AND filename.dst IN ('mshta.exe','wscript.exe') 
  AND later action='createfile' AND filepath contains '___unique_id___' within 120s 
  AND later (network_connect AND request.body matches '[A-Za-z0-9+/]{200,}') within 600s
\\End-to-end PeckBirdy lifecycle: script injection, LOLBin execution, victim identification, and encrypted C2.
\\MITRE: T1218, T1059, T1071.001
