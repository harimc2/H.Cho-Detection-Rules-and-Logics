<ASPX webshell with embedded Base64 assembly written to webroot>
action='createfile' AND filepath contains '\\inetpub\\' OR filepath contains '\\wwwroot\\' AND filepath endswith '.aspx'
  AND file.content contains 'Convert.FromBase64String' || file.content contains 'System.IO.Compression' || file.content contains 'Base64'
  AND NOT file.signer.exists=true
\\ASPX files that contain embedded Base64-compressed binaries / Assembly.Load-style code (Convert.FromBase64String / compression APIs) indicate webshells that load backdoors into w3wp.exe memory.
\\MITRE: T1505.003, T1210, T1059.001

<IIS worker (w3wp.exe) loading .NET assembly from memory via Assembly.Load>
process.filename.src='w3wp.exe' AND action contains 'loadmodule' OR action contains 'assembly.load' OR param.dst contains 'Assembly.Load' || param.dst contains 'Assembly.LoadFrom'
  AND NOT (module.filepath exists on disk && module.filepath startswith 'C:\\Program Files\\')
\\Detection of w3wp.exe loading assemblies directly from memory or via Assembly.Load (no on-disk drop) indicates NET-STAR style fileless in-memory backdoor / AssemblyExecuter behavior.
\\MITRE: T1027, T1055, T1218

<HTTP POSTs to ASPX with cookie session + STAR-delimited/base64 payloads>
action='http_request' AND request.uri endswith '.aspx' AND request.method IN ('POST','PUT') 
  AND request.headers.cookie exists AND request.body contains 'STAR' || request.body matches '[A-Za-z0-9+/]{200,}={0,2}'
  AND avg(request.body.length) > 128
\\Webshell C2 often uses cookie-backed sessions and STAR-delimited or large Base64 payloads in POST bodies to deliver encrypted .NET assemblies/commands to IIServerCore.
\\MITRE: T1071.001, T1210

<Large memory allocation in w3wp followed by outbound C2 and no on-disk drop>
process.filename.src='w3wp.exe' AND action='process_memory_alloc' AND param.dst contains 'VirtualAlloc' || param.dst contains 'VirtualAllocEx' 
  AND later (network_connect AND direction='outbound' AND protocol IN ('HTTP','HTTPS')) 
  AND NOT (action='createfile' AND filepath contains '\\inetpub\\' OR filepath contains '\\Temp\\') within 120s
\\w3wp performing large memory allocations then immediately contacting C2 — characteristic of in-memory .NET payloads loaded and executed without touching disk (IIServerCore/AssemblyExecuter).
\\MITRE: T1055, T1218, T1071

<AssemblyExecuter AMSI/ETW bypass indicators within IIS process>
process.filename.src='w3wp.exe' AND (param.dst contains 'Amsi' OR param.dst contains 'AmsiScanBuffer' OR param.dst contains 'EtwEventWrite' || param.dst contains 'EtwNotificationRegister')
  AND process_modify contains 'patch' || process_modify contains 'hook' || param.dst contains 'Unhook'
\\IIS worker invoking or patching AMSI/ETW-related symbols (AmsiScanBuffer, ETW calls) is consistent with AssemblyExecuter v2 bypass logic to evade detection during in-memory assembly execution.
\\MITRE: T1562.001, T1562.006, T1218

<Webshell timestomp / changeLastModified capability detected (file mtime anomalies)>
action='file_modify' AND filepath endswith '.aspx' OR filepath contains '\\inetpub\\' 
  AND (file.mtime > system.time OR file.mtime significantly differs from directory baseline) 
  AND param.dst contains 'changeLastModified' || param.dst contains 'SetFileTime'
\\NET-STAR / IIServerCore can timestomp webshells and backdoors; unusual AS P X modification times (future or inconsistent with local baseline) indicate timestomping/anti-forensics.
\\MITRE: T1070.006, T1497

<Remote WMI/WMIC execution of mssq.bat or SQL command text on remote DB host>
action='createprocess' AND filename.dst IN ('wmic.exe','wmic.exe','psexec.exe','winrm.exe') 
  AND param.dst contains 'mssq.bat' || param.dst contains 'sqlcmd' || param.dst matches '.*SELECT .*FROM .*' 
  AND later (file.createfile AND filepath endswith '.csv' OR param.dst contains 'INTO OUTFILE') within 600s
\\Execution of a BAT/SQL command remotely (WMI/PsExec) that runs dynamic SQL queries and writes CSV exports matches Phantom Taurus behavior (mssq.bat) for targeted database collection.
\\MITRE: T1021.002, T1046, T1537

<ASPX webshell creating or managing other web shells via addShell/listShell semantics>
action='http_request' AND request.uri endswith '.aspx' AND (request.body contains 'addshell' || request.body contains 'listShell' || request.body contains 'addShell') 
  AND later (action='createfile' AND filepath contains '\\inetpub\\' AND filepath endswith '.aspx') within 300s
\\NET-STAR supports web shell management (addshell, listShell); HTTP requests containing these control strings followed by new ASPX creations indicate webshell proliferation/management.
\\MITRE: T1505.003, T1210

<ASPX loader that embeds compressed binary then loads ServerRun.Run (in-memory) — createfile + immediate w3wp in-memory load>
action='createfile' AND filepath endswith '.aspx' AND file.content contains 'ServerRun' || file.content contains 'Run(' 
  AND later (process.filename.src='w3wp.exe' AND action contains 'assembly.load' OR process_memory_alloc) within 120s
\\ASPX containing ServerRun/Run class strings followed by w3wp in-memory assembly loading is a signature of the IIServerCore fileless backdoor loading into the worker process.
\\MITRE: T1218, T1505.003, T1055

<HTTP requests to ASPX that cause dynamic SQL execution / DB command relay>
action='http_request' AND request.uri endswith '.aspx' AND (request.body contains 'executeSQLQuery' || request.body contains 'ExecuteNonQuery' || request.body contains 'run_sql' ) 
  AND later (network_connect AND dest.port IN (1433,3306,1521) OR action='createprocess' AND filename.dst IN ('sqlcmd.exe','osql.exe')) within 300s
\\IIServerCore supports database access and can accept SQL execution commands via HTTP; detecting ASPX requests with SQL-execution-like payloads followed by DB access indicates data collection from backend DBs.
\\MITRE: T1537, T1059.003

<Timestamped high-confidence chain: webshell drop → w3wp in-memory load → STAR/BASE64 payload POST → Assembly.Load execution>
action='createfile' AND filepath endswith '.aspx' AND file.content contains 'Convert.FromBase64String' 
  AND later (process.filename.src='w3wp.exe' AND action contains 'process_memory_alloc' OR action contains 'assembly.load') 
  AND later (action='http_request' AND request.uri endswith '.aspx' AND request.body contains 'STAR' || request.body matches '[A-Za-z0-9+/]{200,}') 
  AND later (process.filename.src='w3wp.exe' AND param.dst contains 'Assembly.Load' OR action contains 'run_code')
\\Sequence: webshell with embedded Base64 → w3wp memory load → STAR-delimited/Base64 C2 POST → Assembly.Load/run_code indicates high-confidence NET-STAR infection lifecycle (IIServerCore + AssemblyExecuter).
\\MITRE: T1505.003, T1218, T1071.001, T1059.001

<Detection of compressed/encrypted response patterns sent from w3wp after command execution>
action='http_response' AND response.headers.content_encoding IN ('gzip','deflate') || response.body matches '[A-Za-z0-9+/]{200,}' 
  AND source.process='w3wp.exe' AND response.headers.set_cookie exists
\\IIServerCore compresses/encrypts command output and returns it via HTTP responses (gzip + Base64). Gzip-encoded or large Base64 response bodies with session cookies indicate encrypted C2 data exfil from the webserver.
\\MITRE: T1041, T1071.001

<Fileless / in-memory indicator: no on-disk module but sequence of webshell POST → w3wp large memory alloc → Assembly.Load and subsequent AES/ECB crypto API usage>
action='http_request' AND request.uri endswith '.aspx' AND request.body contains 'STAR' 
  AND later (process.filename.src='w3wp.exe' AND action contains 'process_memory_alloc' AND later process.api_call contains 'Aes.Create' || process.api_call contains 'CreateEncryptor') within 180s
\\NET-STAR uses in-memory AES (ECB PKCS7) and compression pipelines. Detecting memory allocation + .NET crypto API usage in w3wp following a webshell POST is a strong indicator of encrypted in-memory payload processing.
\\MITRE: T1002, T1027, T1071.001

<Forensic note: ASPX compilation timestamps modified to future / mismatched compile-time in PE headers>
action='file_read' AND filepath endswith '.aspx' OR filepath endswith '.dll' 
  AND (file.pe.compile_timestamp > system.time OR file.pe.compile_timestamp significantly differs from neighboring file timestamps)
\\Phantom Taurus timestomps and sets compile timestamps to random future dates to confuse forensics; detection of compilation timestamps in the future or inconsistent with local estate is an anti-forensic clue.
\\MITRE: T1070.006, T1497

<NET-STAR admin commands: web requests that trigger file-system operations then CSV export creation>
action='http_request' AND request.uri endswith '.aspx' AND (request.body contains 'fileRead' || request.body contains 'listDir' || request.body contains 'executeSQLQuery') 
  AND later (action='createfile' AND filepath endswith '.csv' OR action='createfile' AND filepath contains '\\inetpub\\') within 600s
\\IIServerCore built-in commands include file system ops and SQL export functions; requests invoking these commands followed by CSV/file creation indicate data collection + staging.
\\MITRE: T1119, T1537, T1059.001
